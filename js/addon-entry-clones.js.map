{"version":3,"file":"js/addon-entry-clones.js","sources":["webpack://GUI/./src/addons/addons/clones/style.css","webpack://GUI/./src/addons/addons/clones/300cats.svg","webpack://GUI/./src/addons/addons/clones/_runtime_entry.js","webpack://GUI/./src/addons/addons/clones/cat.svg","webpack://GUI/./src/addons/addons/clones/userscript.js"],"sourcesContent":["var escape = require(\"../../../../node_modules/css-loader/lib/url/escape.js\");\nexports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".clone-container-container {\\r\\n  display: none;\\r\\n  align-items: center;\\r\\n  padding: 0.25rem;\\r\\n  user-select: none;\\r\\n  color: #a065ff;\\r\\n}\\r\\n\\r\\n.clone-container {\\r\\n  font-size: 0.625rem;\\r\\n  font-weight: bold;\\r\\n  font-family: \\\"Helvetica Neue\\\", Helvetica, Arial, sans-serif;\\r\\n  white-space: nowrap;\\r\\n}\\r\\n\\r\\n.clone-icon {\\r\\n  margin: 0.25rem;\\r\\n  display: inline-block;\\r\\n  background-image: url(\" + escape(require(\"./cat.svg\")) + \");\\r\\n  height: 16px;\\r\\n  width: 16px;\\r\\n}\\r\\n\\r\\n.clone-container-container[data-count=\\\"none\\\"] {\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n.clone-container-container[data-count=\\\"full\\\"] {\\r\\n  color: #ff6680;\\r\\n}\\r\\n\\r\\n.clone-container-container[data-count=\\\"full\\\"] .clone-icon {\\r\\n  background-image: url(\" + escape(require(\"./300cats.svg\")) + \");\\r\\n}\\r\\n\\r\\n.clone-count::after {\\r\\n  content: attr(data-str);\\r\\n}\\r\\n\\r\\n.sa-clones-small .clone-container-container {\\r\\n  display: none !important;\\r\\n}\\r\\n\", \"\"]);\n\n// exports\n","module.exports = __webpack_public_path__ + \"static/assets/60fb267c5ab0c6f4ed9ab4a891ca7dd5.svg\";","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nimport _css from \"!css-loader!./style.css\";\nexport const resources = {\n  \"userscript.js\": _js,\n  \"style.css\": _css,\n};\n","module.exports = __webpack_public_path__ + \"static/assets/8a30520407ffdf5b0e7e06e490db9c1d.svg\";","export default async function ({ addon, global, console, msg }) {\r\n  const vm = addon.tab.traps.vm;\r\n\r\n  if (addon.tab.redux.state && addon.tab.redux.state.scratchGui.stageSize.stageSize === \"small\") {\r\n    document.body.classList.add(\"sa-clones-small\");\r\n  }\r\n  document.addEventListener(\r\n    \"click\",\r\n    (e) => {\r\n      if (e.target.closest(\"[class*='stage-header_stage-button-first']\")) {\r\n        document.body.classList.add(\"sa-clones-small\");\r\n      } else if (e.target.closest(\"[class*='stage-header_stage-button-last']\")) {\r\n        document.body.classList.remove(\"sa-clones-small\");\r\n      }\r\n    },\r\n    { capture: true }\r\n  );\r\n\r\n  let countContainerContainer = document.createElement(\"div\");\r\n  addon.tab.displayNoneWhileDisabled(countContainerContainer);\r\n\r\n  let countContainer = document.createElement(\"div\");\r\n  let count = document.createElement(\"span\");\r\n  let icon = document.createElement(\"span\");\r\n\r\n  countContainerContainer.className = \"clone-container-container\";\r\n  countContainer.className = \"clone-container\";\r\n  count.className = \"clone-count\";\r\n  icon.className = \"clone-icon\";\r\n\r\n  countContainerContainer.appendChild(icon);\r\n  countContainerContainer.appendChild(countContainer);\r\n  countContainer.appendChild(count);\r\n\r\n  let lastChecked = 0;\r\n\r\n  const cache = Array(301)\r\n    .fill()\r\n    .map((_, i) => msg(\"clones\", { cloneCount: i }));\r\n\r\n  function doCloneChecks() {\r\n    const v = vm.runtime._cloneCounter;\r\n    // performance\r\n    if (v === lastChecked) return;\r\n    lastChecked = v;\r\n    if (v === 0) {\r\n      countContainerContainer.dataset.count = \"none\";\r\n    } else if (v >= vm.runtime.runtimeOptions.maxClones) {\r\n      countContainerContainer.dataset.count = \"full\";\r\n    } else {\r\n      countContainerContainer.dataset.count = \"\";\r\n    }\r\n    count.dataset.str = cache[v] || msg(\"clones\", { cloneCount: v });\r\n\r\n    if (v === 0) countContainerContainer.style.display = \"none\";\r\n    else countContainerContainer.style.display = \"flex\";\r\n  }\r\n\r\n  const oldStep = vm.runtime._step;\r\n  vm.runtime._step = function (...args) {\r\n    const ret = oldStep.call(this, ...args);\r\n    doCloneChecks();\r\n    return ret;\r\n  };\r\n\r\n  while (true) {\r\n    await addon.tab.waitForElement('[class*=\"controls_controls-container\"]', {\r\n      markAsSeen: true,\r\n      reduxEvents: [\"scratch-gui/mode/SET_PLAYER\", \"fontsLoaded/SET_FONTS_LOADED\", \"scratch-gui/locales/SELECT_LOCALE\"],\r\n    });\r\n\r\n    if (addon.tab.editorMode === \"editor\") {\r\n      addon.tab.appendToSharedSpace({ space: \"afterStopButton\", element: countContainerContainer, order: 2 });\r\n    }\r\n  }\r\n}\r\n"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACRA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;;;;;;;;;;;ACHA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAGA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AAEA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AAIA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;;;;A","sourceRoot":""}