{"version":3,"file":"js/addon-entry-hide-flyout.js","sources":["webpack://GUI/./src/addons/addons/hide-flyout/style.css","webpack://GUI/./src/addons/addons/hide-flyout/lock.svg","webpack://GUI/./src/addons/addons/hide-flyout/unlock.svg","webpack://GUI/./src/addons/addons/hide-flyout/_runtime_entry.js","webpack://GUI/./src/addons/addons/hide-flyout/userscript.js"],"sourcesContent":["exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".blocklyFlyout,\\r\\n.blocklyFlyoutScrollbar,\\r\\n.sa-lock-image {\\r\\n  transition-property: transform;\\r\\n}\\r\\n\\r\\n.blocklyFlyout.sa-flyoutClose {\\r\\n  transform: translateX(-200px) !important;\\r\\n}\\r\\n\\r\\n.blocklyFlyoutScrollbar.sa-flyoutClose {\\r\\n  transform: translateX(35px) !important;\\r\\n}\\r\\n\\r\\n.sa-lock-image.sa-flyoutClose {\\r\\n  transform: translateX(-260px);\\r\\n}\\r\\n\\r\\n.sa-flyout-placeHolder {\\r\\n  position: absolute;\\r\\n  left: 61px;\\r\\n  top: 44px;\\r\\n  height: 100%;\\r\\n  width: 251px;\\r\\n}\\r\\n\\r\\n.sa-lock-image {\\r\\n  position: absolute;\\r\\n  z-index: 20;\\r\\n  width: 20px;\\r\\n  cursor: pointer;\\r\\n  top: 46px;\\r\\n  left: 280px;\\r\\n}\\r\\n\\r\\n.injectionDiv {\\r\\n  overflow: hidden !important;\\r\\n}\\r\\n\", \"\"]);\n\n// exports\n","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGFyaWEtaGlkZGVuPSJ0cnVlIiB3aWR0aD0iMWVtIiBoZWlnaHQ9IjFlbSIgc3R5bGU9Ii1tcy10cmFuc2Zvcm06cm90YXRlKDM2MGRlZyk7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDM2MGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0xMiAxM2ExIDEgMCAwIDAtMSAxdjNhMSAxIDAgMCAwIDIgMHYtM2ExIDEgMCAwIDAtMS0xem01LTRWN0E1IDUgMCAwIDAgNyA3djJhMyAzIDAgMCAwLTMgM3Y3YTMgMyAwIDAgMCAzIDNoMTBhMyAzIDAgMCAwIDMtM3YtN2EzIDMgMCAwIDAtMy0zek05IDdhMyAzIDAgMCAxIDYgMHYySDl6bTkgMTJhMSAxIDAgMCAxLTEgMUg3YTEgMSAwIDAgMS0xLTF2LTdhMSAxIDAgMCAxIDEtMWgxMGExIDEgMCAwIDEgMSAxeiIgZmlsbD0iIzYyNjI2MiIvPjwvc3ZnPg==\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGFyaWEtaGlkZGVuPSJ0cnVlIiB3aWR0aD0iMWVtIiBoZWlnaHQ9IjFlbSIgc3R5bGU9Ii1tcy10cmFuc2Zvcm06cm90YXRlKDM2MGRlZyk7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDM2MGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0xMiAxM2ExLjQ5IDEuNDkgMCAwIDAtMSAyLjYxVjE3YTEgMSAwIDAgMCAyIDB2LTEuMzlBMS40OSAxLjQ5IDAgMCAwIDEyIDEzem01LTRIOVY3YTMgMyAwIDAgMSA1LjEyLTIuMTMgMy4wOCAzLjA4IDAgMCAxIC43OCAxLjM4IDEgMSAwIDEgMCAxLjk0LS41IDUuMDkgNS4wOSAwIDAgMC0xLjMxLTIuMjlBNSA1IDAgMCAwIDcgN3YyYTMgMyAwIDAgMC0zIDN2N2EzIDMgMCAwIDAgMyAzaDEwYTMgMyAwIDAgMCAzLTN2LTdhMyAzIDAgMCAwLTMtM3ptMSAxMGExIDEgMCAwIDEtMSAxSDdhMSAxIDAgMCAxLTEtMXYtN2ExIDEgMCAwIDEgMS0xaDEwYTEgMSAwIDAgMSAxIDF6IiBmaWxsPSIjNjI2MjYyIi8+PC9zdmc+\"","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nimport _css from \"!css-loader!./style.css\";\nexport const resources = {\n  \"userscript.js\": _js,\n  \"style.css\": _css,\n};\n","/* inserted by pull.js */\nimport _twAsset0 from \"!url-loader!./lock.svg\";\nimport _twAsset1 from \"!url-loader!./unlock.svg\";\nconst _twGetAsset = (path) => {\n  if (path === \"/lock.svg\") return _twAsset0;\n  if (path === \"/unlock.svg\") return _twAsset1;\n  throw new Error(`Unknown asset: ${path}`);\n};\n\nexport default async function ({ addon, global, console }) {\r\n  let placeHolderDiv = null;\r\n  let lockDisplay = null;\r\n  let flyOut = null;\r\n  let scrollBar = null;\r\n  let toggle = true;\r\n  let selectedCategory = null;\r\n  let toggleSetting = addon.settings.get(\"toggle\");\r\n  let flyoutLock = false;\r\n\r\n  function getSpeedValue() {\r\n    let data = {\r\n      none: \"0\",\r\n      short: \"0.25\",\r\n      default: \"0.5\",\r\n      long: \"1\",\r\n    };\r\n    return data[addon.settings.get(\"speed\")];\r\n  }\r\n  function onmouseenter(e, speed = {}) {\r\n    // If a mouse event was passed, only open flyout if the workspace isn't being dragged\r\n    if (\r\n      !e ||\r\n      e.buttons === 0 ||\r\n      document.querySelector(\".blocklyToolboxDiv\").className.includes(\"blocklyToolboxDelete\")\r\n    ) {\r\n      speed = typeof speed === \"object\" ? getSpeedValue() : speed;\r\n      flyOut.classList.remove(\"sa-flyoutClose\");\r\n      flyOut.style.transitionDuration = `${speed}s`;\r\n      scrollBar.classList.remove(\"sa-flyoutClose\");\r\n      scrollBar.style.transitionDuration = `${speed}s`;\r\n      lockDisplay.classList.remove(\"sa-flyoutClose\");\r\n      lockDisplay.style.transitionDuration = `${speed}s`;\r\n      setTimeout(() => Blockly.getMainWorkspace().recordCachedAreas(), speed * 1000);\r\n    }\r\n  }\r\n  function onmouseleave(e, speed = getSpeedValue()) {\r\n    // If we go behind the flyout or the user has locked it, let's return\r\n    if ((toggleSetting !== \"cathover\" && e && e.clientX <= scrollBar.getBoundingClientRect().left) || flyoutLock)\r\n      return;\r\n    flyOut.classList.add(\"sa-flyoutClose\");\r\n    flyOut.style.transitionDuration = `${speed}s`;\r\n    scrollBar.classList.add(\"sa-flyoutClose\");\r\n    scrollBar.style.transitionDuration = `${speed}s`;\r\n    lockDisplay.classList.add(\"sa-flyoutClose\");\r\n    lockDisplay.style.transitionDuration = `${speed}s`;\r\n    setTimeout(() => Blockly.getMainWorkspace().recordCachedAreas(), speed * 1000);\r\n  }\r\n\r\n  let didOneTimeSetup = false;\r\n  function doOneTimeSetup() {\r\n    if (didOneTimeSetup) {\r\n      return;\r\n    }\r\n    didOneTimeSetup = true;\r\n    addon.tab.redux.initialize();\r\n    addon.tab.redux.addEventListener(\"statechanged\", (e) => {\r\n      switch (e.detail.action.type) {\r\n        // Event casted when you switch between tabs\r\n        case \"scratch-gui/navigation/ACTIVATE_TAB\":\r\n          // always 0, 1, 2\r\n          lockDisplay.style.display = e.detail.action.activeTabIndex === 0 ? \"block\" : \"none\";\r\n          placeHolderDiv.style.display = e.detail.action.activeTabIndex === 0 ? \"block\" : \"none\";\r\n          if (e.detail.action.activeTabIndex === 0) {\r\n            onmouseenter(null, 0);\r\n            toggle = true;\r\n          }\r\n          break;\r\n        // Event casted when you switch between tabs\r\n        case \"scratch-gui/mode/SET_PLAYER\":\r\n          // always true or false\r\n          lockDisplay.style.display = e.detail.action.isPlayerOnly ? \"none\" : \"block\";\r\n          placeHolderDiv.style.display = e.detail.action.activeTabIndex === 0 ? \"block\" : \"none\";\r\n          break;\r\n      }\r\n    });\r\n    if (toggleSetting === \"category\" || toggleSetting === \"cathover\") {\r\n      (async () => {\r\n        while (true) {\r\n          let category = await addon.tab.waitForElement(\".scratchCategoryMenuItem\", {\r\n            markAsSeen: true,\r\n            condition: () => !addon.tab.redux.state.scratchGui.mode.isPlayerOnly,\r\n          });\r\n          category.onclick = () => {\r\n            if (toggle && selectedCategory === category && toggleSetting === \"category\") {\r\n              onmouseleave();\r\n              selectedCategory = category;\r\n            } else if (!toggle) {\r\n              onmouseenter();\r\n              selectedCategory = category;\r\n            } else {\r\n              selectedCategory = category;\r\n              return;\r\n            }\r\n            if (toggleSetting === \"category\") toggle = !toggle;\r\n          };\r\n        }\r\n      })();\r\n    }\r\n  }\r\n\r\n  while (true) {\r\n    flyOut = await addon.tab.waitForElement(\".blocklyFlyout\", {\r\n      markAsSeen: true,\r\n      reduxCondition: (state) => !state.scratchGui.mode.isPlayerOnly,\r\n    });\r\n    let blocklySvg = document.querySelector(\".blocklySvg\");\r\n    scrollBar = document.querySelector(\".blocklyFlyoutScrollbar\");\r\n    const tabs = document.querySelector('[class^=\"gui_tabs\"]');\r\n\r\n    // Placeholder Div\r\n    if (placeHolderDiv) placeHolderDiv.remove();\r\n    placeHolderDiv = document.createElement(\"div\");\r\n    if (toggleSetting === \"hover\") tabs.appendChild(placeHolderDiv);\r\n    placeHolderDiv.className = \"sa-flyout-placeHolder\";\r\n\r\n    // Lock Img\r\n    if (lockDisplay) lockDisplay.remove();\r\n    lockDisplay = document.createElement(\"img\");\r\n    lockDisplay.src = _twGetAsset(`/${flyoutLock ? \"\" : \"un\"}lock.svg`);\r\n    lockDisplay.className = \"sa-lock-image\";\r\n    lockDisplay.onclick = () => {\r\n      flyoutLock = !flyoutLock;\r\n      lockDisplay.src = _twGetAsset(`/${flyoutLock ? \"\" : \"un\"}lock.svg`);\r\n    };\r\n\r\n    // Only append if we don't have \"categoryclick\" on\r\n    if (toggleSetting === \"hover\") tabs.appendChild(lockDisplay);\r\n\r\n    if (toggleSetting === \"hover\") {\r\n      placeHolderDiv.onmouseenter = (e) => onmouseenter(e);\r\n      placeHolderDiv.onmouseup = (e) => onmouseenter();\r\n      document.querySelector(\".blocklyToolboxDiv\").onmouseenter = (e) => onmouseenter(e); // for columns\r\n      blocklySvg.onmouseenter = (e) => onmouseleave(e);\r\n    }\r\n\r\n    if (toggleSetting === \"cathover\") {\r\n      onmouseleave(null, 0);\r\n\r\n      const toolbox = document.querySelector(\".blocklyToolboxDiv\");\r\n      const addExtensionButton = document.querySelector(\"[class^=gui_extension-button-container_]\");\r\n\r\n      for (let e of [toolbox, addExtensionButton, flyOut, scrollBar]) {\r\n        e.onmouseenter = onmouseenter;\r\n        e.onmouseleave = onmouseleave;\r\n      }\r\n    }\r\n\r\n    doOneTimeSetup();\r\n  }\r\n}\r\n"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACPA;AAAA;;;;;;;;;;;;ACAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAhBA;AAkBA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}