{"version":3,"file":"js/addon-entry-custom-zoom.js","sources":["webpack://GUI/./src/addons/addons/custom-zoom/style.css","webpack://GUI/./src/addons/addons/custom-zoom/_runtime_entry.js","webpack://GUI/./src/addons/addons/custom-zoom/userscript.js"],"sourcesContent":["exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".sa-custom-zoom-area {\\r\\n  position: absolute;\\r\\n  bottom: 0;\\r\\n  right: 0;\\r\\n  width: 60px;\\r\\n  height: 148px;\\r\\n  pointer-events: none;\\r\\n}\\r\\n.blocklyZoom > * {\\r\\n  transition: transform var(--sa-custom-zoom-speed, 0) ease-in-out;\\r\\n}\\r\\n.sa-custom-zoom-hidden > * {\\r\\n  transform: translateX(80px);\\r\\n}\\r\\n\", \"\"]);\n\n// exports\n","/* generated by pull.js */\nimport _js from \"./userscript.js\";\nimport _css from \"!css-loader!./style.css\";\nexport const resources = {\n  \"userscript.js\": _js,\n  \"style.css\": _css,\n};\n","export default async function ({ addon, global, console }) {\r\n  await addon.tab.traps.getBlockly();\r\n\r\n  let controlsRect;\r\n  let previousIsHovered = false;\r\n  const speeds = {\r\n    none: \"0s\",\r\n    short: \"0.25s\",\r\n    default: \"0.5s\",\r\n    long: \"1s\",\r\n  };\r\n\r\n  const customZoomAreaElement = document.createElement(\"div\");\r\n  customZoomAreaElement.className = \"sa-custom-zoom-area\";\r\n\r\n  function update() {\r\n    document.removeEventListener(\"mousemove\", onMouseMove);\r\n\r\n    if (addon.tab.editorMode !== \"editor\") return;\r\n\r\n    Blockly.getMainWorkspace().options.zoomOptions.maxScale = addon.settings.get(\"maxZoom\") / 100;\r\n    Blockly.getMainWorkspace().options.zoomOptions.minScale = addon.settings.get(\"minZoom\") / 100;\r\n    Blockly.getMainWorkspace().options.zoomOptions.startScale = addon.settings.get(\"startZoom\") / 100;\r\n    Blockly.getMainWorkspace().options.zoomOptions.scaleSpeed = 1 + 0.2 * (addon.settings.get(\"zoomSpeed\") / 100);\r\n\r\n    const svgGroup = getZoomControls();\r\n    const autohide = addon.settings.get(\"autohide\");\r\n    if (svgGroup) svgGroup.classList.toggle(\"sa-custom-zoom-hidden\", autohide);\r\n    if (autohide) {\r\n      const injectionDiv = document.querySelector(\".injectionDiv\");\r\n      injectionDiv.appendChild(customZoomAreaElement);\r\n      updateRect();\r\n      document.addEventListener(\"mousemove\", onMouseMove);\r\n    }\r\n  }\r\n\r\n  function getZoomControls() {\r\n    const zoomControls = Blockly.getMainWorkspace().zoomControls_;\r\n    if (zoomControls) return zoomControls.svgGroup_;\r\n    return null;\r\n  }\r\n\r\n  function onMouseMove(e) {\r\n    const isHovered =\r\n      e.x > controlsRect.left && e.x < controlsRect.right && e.y > controlsRect.top && e.y < controlsRect.bottom;\r\n    if (isHovered !== previousIsHovered) {\r\n      previousIsHovered = isHovered;\r\n      const svgGroup = getZoomControls();\r\n      if (svgGroup) {\r\n        svgGroup.style.setProperty(\"--sa-custom-zoom-speed\", speeds[addon.settings.get(\"speed\")]);\r\n        svgGroup.classList.toggle(\"sa-custom-zoom-hidden\", !isHovered);\r\n      }\r\n    }\r\n  }\r\n\r\n  function updateRect() {\r\n    controlsRect = customZoomAreaElement.getBoundingClientRect();\r\n  }\r\n\r\n  function onResize() {\r\n    if (addon.tab.editorMode === \"editor\" && addon.settings.get(\"autohide\")) {\r\n      updateRect();\r\n    }\r\n  }\r\n\r\n  await addon.tab.waitForElement(\".blocklyZoom\");\r\n  if (document.querySelector('[class^=\"backpack_backpack-container\"]')) {\r\n    window.dispatchEvent(new Event(\"resize\"));\r\n  }\r\n  update();\r\n  addon.tab.addEventListener(\"urlChange\", update);\r\n  addon.settings.addEventListener(\"change\", update);\r\n  window.addEventListener(\"resize\", onResize);\r\n}\r\n"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACPA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAOA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}